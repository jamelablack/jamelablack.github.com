<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Intro to Ruby & Web Dev: Lesson 3 &middot; grit| commit
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0c">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          <span style="color: #FF6347; font: Verdana">grit| commit</span>
        </a>
      </h1>
      <p class="lead">daily learnings as a ruby dev</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Intro to Ruby & Web Dev: Lesson 3</h1>
  <span class="post-date">14 Sep 2014</span>
  <h1>Items covered</h1>

<ol>
<li>HTTP Request/Response Cycle</li>
<li>MVC</li>
<li>Sinatra(Shotgun)</li>
<li>Erb</li>
<li>Persistence</li>
</ol>

<h1>Difference b/w websites and web applications</h1>

<ol>
<li>Websites - static HTML, web server</li>
<li>Web Applications - Actual server</li>
</ol>

<h2>HTTP</h2>

<p>is broken up into 2 actions:</p>

<ol>
<li>Request

<ul>
<li>HTTP Verbs/Method</li>
<li>URL</li>
<li>Parameters</li>
</ul></li>
<li><p>Response</p>

<ul>
<li>Status Code</li>
<li>Payload (not necessarily HTML all the time... could be JSON, XML)
HTTP is also stateless. B/w every request, the browser must reconsitute the world to resemeble that current state.
__________________</li>
</ul></li>
<li><p>Request - any interaction that you have with a web application</p>

<ul>
<li>2 Types of Requests - this is how a user interacts with the website</li>
<li>HTTP Verbs</li>
<li>GET

<ul>
<li>Link or type into address bar</li>
<li>smaller payload (there is a size limit)</li>
<li>parameters are a apart of the URL</li>
</ul></li>
<li>POST

<ul>
<li>forms</li>
<li>larger payload</li>
<li>parameters are submitted in the body</li>
</ul></li>
<li>parameters are submitted as apart of a form</li>
<li>HTTP Methods</li>
</ul></li>
<li><p>Response</p>

<ul>
<li>Status Code</li>
<li>200: ok</li>
<li>301: redirect</li>
<li>404: File not found</li>
<li>500: general error</li>
</ul></li>
</ol>

<h2>MVC</h2>

<p>Person visits site and a request is to the controller/actions.
Depending on the HTTP Verb, URL, and parameters passed - the controller will reference the model for the logic
and the model, in turn will potentially reach to the database. Once retrieved, the controller render a view.</p>

<p>We are foregoing the model and focusing on the request and render features, using a cookie as our sessions.</p>

<h2>Sinatra App</h2>

<p>Sinatra uses localhost:4567</p>

<p>Sinatra doesn&#39;t automatically reload - for this, install shotgun and run &#39;ruby main.rb&#39; =&gt; localhost:9393</p>

<h3>Shotgun</h3>

<p>Allows your browser to refresh and updates with changes without stopping the server.</p>

<p>Install in terminal: gem install Shotgun.</p>

<p>Launched via port:9393 by running &quot;shotgun main.rb&quot;</p>

<p>Link is loaded at &#39;/&#39;</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">In</span> <span class="n">main</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span>

<span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span>
  <span class="s2">&quot;Hello World&quot;</span> <span class="o">+</span><span class="n">params</span><span class="o">[</span><span class="ss">:some</span><span class="o">].</span><span class="n">to_s</span>
<span class="k">end</span></code></pre></div>

<h2>Erb</h2>

<p>Instead of working with code directly - HTML, etc , we want to work with templates (.erb)</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">  get &#39;test/&#39; do
    erb :test
  end
</code></pre></div>
<ul>
<li>Create test.erb (layout: false) - to remove layout</li>
</ul>

<p>Instance variables setup in the action are available in the template, but only the template is being rendered</p>

<p>Erb =&gt; Embedded Ruby</p>

<p>&lt;% %&gt; Ruby code that doesn&#39;t need to be printed to HTML
&lt;%= %&gt; Ruby code that should be printed out to HTML</p>

<hr>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">main</span><span class="o">.</span><span class="n">rb</span>
<span class="n">get</span> <span class="s1">&#39;/test&#39;</span> <span class="k">do</span>
  <span class="vi">@error</span> <span class="o">=</span> <span class="s2">&quot;We&#39;ve got a problem&quot;</span>
  <span class="n">erb</span> <span class="ss">:test</span> <span class="o">***</span> <span class="n">points</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">test</span><span class="o">.</span><span class="n">erb</span> <span class="n">template</span> <span class="n">under</span> <span class="n">the</span> <span class="n">views</span><span class="o">***</span>
<span class="k">end</span></code></pre></div>

<hr>

<h2>Persistance</h2>

<p>The problem is that accessing the instance variable is only available upon request.
To display form:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#main.rb</span>
<span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span>
  <span class="n">erb</span> <span class="ss">:set_name</span>
<span class="k">end</span></code></pre></div>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#set_name.erb (Handles the display of data)</span>
<span class="o">&lt;</span><span class="n">h4</span><span class="o">&gt;</span> <span class="no">Set</span> <span class="no">Player</span> <span class="no">Name</span> <span class="o">&lt;</span><span class="sr">/h4&gt;</span>

<span class="sr">&lt;form action=&#39;/se</span><span class="n">t_name</span><span class="s1">&#39; method=&#39;</span><span class="n">post</span><span class="s1">&#39;</span>
<span class="s1">  Name: &lt;input type=&#39;</span><span class="n">text</span><span class="s1">&#39; name=&#39;</span><span class="n">player_name</span><span class="s1">&#39; /&gt;</span>
<span class="s1">  &lt;/br&gt;</span>
<span class="s1">  &lt;input type =&#39;</span><span class="n">submit</span><span class="s1">&#39; class=&#39;</span><span class="n">btn</span><span class="err">&#39;</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="sr">/form&gt;</span></code></pre></div>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#main.rb (handle the submission of the data)</span>

<span class="n">post</span> <span class="s1">&#39;set_name&#39;</span> <span class="k">do</span>
<span class="k">end</span></code></pre></div>

<p>Whenever making changes to the HTML, you must refresh the browser to take effect.</p>

<p>In order to fix persistence problem, you must use session instead of an instance variable. This allows use to work with cookies( has a limit of 4 kilobytes instead of dealing with relational databases. Can&#39;t deal with more than one decks.:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">post</span> <span class="s1">&#39;/set_name&#39;</span> <span class="k">do</span>
  <span class="n">session</span><span class="o">[</span><span class="ss">:player_name</span><span class="o">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:player_name</span><span class="o">]</span>
<span class="k">end</span></code></pre></div>

<p>Sessions can be referenced directly because of the use of cookies.
We know that cookies have tied to the session because we did not reference an instance variables.</p>

<p>You can use the following to reference in your templates in order to display content dynamically and reconstitute all the states you expect.
1. Instance variables
2. Sessions
3. helper methods</p>

<p>The key is to figure out when you will redirect or render:</p>

<ul>
<li>Post - typically redirect</li>
<li>Get - typically render</li>
</ul>

<p>Sinatra is typically very much to the metal and handles much less than Rails.</p>

<p><strong>NOTES FROM BLACKJACK GAME</strong></p>

<ol>
<li><p>main.rb is the game engine.</p></li>
<li><p>Constants: use constants when numbers are consistent through out the the game. This will allow you to be able the rules of the game in the future without having to comb through the code to find where to make the change.</p></li>
<li><p>&quot;set :sessions, true&quot; facilitates some level of persistency, reconstitutes state and allows for your player info to tracked for that session.</p></li>
<li><p>Helpers - &quot;helpers do .... end&quot; any methods within this block will be accessible in both the game engine (main.rb) and the (.erb) templates.</p></li>
<li><p>Used @error and @success bootstrap instance variables to communicate special messages</p></li>
<li><p>Require new player to enter in name:
  post &#39;/new<em>player&#39; do
    if params[:player</em>name].empty?
      @error = &quot;Name is required.&quot;
      halt erb(:new<em>player) #stop, don&#39;t execute anything below this, render template instead.
    end
    session[:player</em>name] = params[:player_name]
    redirect &#39;/game&#39;
  end</p></li>
<li><p>Keep track of who&#39;s turn it is with:</p></li>
</ol>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">session</span><span class="o">[</span><span class="ss">:turn</span><span class="o">]</span> <span class="o">=</span> <span class="n">session</span><span class="o">[</span><span class="ss">:player_name</span><span class="o">]</span>
      <span class="ow">or</span>
    <span class="n">session</span><span class="o">[</span><span class="ss">:turn</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;dealer&quot;</span></code></pre></div>

<ol>
<li><p>Instance Variables: using instance variables allow your game engine to communicate to your layout template and the data is erased as soon as another request comes in.</p></li>
<li><p>halt erb(:new_player) #means stop, don&#39;t execute anything below this, render template instead.</p></li>
<li><p>Always include &quot;erb :game&quot; to render the desired template rather than creating a redirect loop.</p></li>
<li><p>When using post in main.rb and forms in .erb, you must specify the method as &quot;post&quot; in erb becasue the default is GET if you don&#39;t specify.</p></li>
</ol>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;/new_player&#39;</span> <span class="nb">method</span><span class="o">=</span><span class="s2">&quot;post&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="nb">name</span><span class="o">=</span><span class="s2">&quot;player_name&quot;</span> <span class="sr">/&gt;</span>
<span class="sr">      &lt;br/</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;btn btn-inverse&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Let&#39;s Play!&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/form&gt;</span></code></pre></div>

<ol>
<li>You must designate method=&quot;post&quot;, the default is &quot;get&quot;.</li>
<li>Must give the input &quot;text&quot; an arbitrary name, in this instance, we chose &quot;player_name&quot;</li>
<li><p>main.rb: under post, params is reset everytime you call it, so we must set the params[:player<em>name] = session[:player</em>name]</p></li>
<li><p>There are different input types for forms including:</p></li>
</ol>

<p>input type = submit
  input type = text, name = :player_name (must specify a name to track the value)</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/04/20/course3-POODR-ch1/">
            POODR - Ch1: Object Oriented Design
            <small>20 Apr 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/04/16/course3-mailgun/">
            Build Robust & Production Quality Applications - Lesson 6: Mailgun
            <small>16 Apr 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/04/13/course3-email-service-providers/">
            Build Robust & Production Quality Applications - Lesson 6: Email Service Providers
            <small>13 Apr 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
